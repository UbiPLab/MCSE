DE Personal privacy; Image encryption; Reversible data hiding; Stream
   encryption; Block permutation
AB Reversible data hiding (RDH) has to be conducted in the encrypted images when original images are encrypted for privacy protection in some open environments, including the cloud computing. However, the current RDH algorithms in encrypted images with error-free decryption may lead to leakage of image content and low embedding rate. In this paper, a novel RDH algorithm for image in encryption domain is proposed. To improve security, we propose a combined block permutation and a stream cipher into the encryption step, which considers data hiding in later steps. We further increase the embedding rate by proposing bit replacement in prediction error. This scheme has the advantages of built-in embedding flag, error-free decryption and high embedding rate. It can be applied to a wide variety of scenarios: If the recipient has only the data-hiding key, he can extract the hidden data but cannot restore the image; If the recipient has only the image encryption key, he can read the distorted image but cannot extract the hidden data; If the recipient has both keys, he can extract the hidden data and restore the original image completely.